AC_INIT(src/zm.h)
AM_INIT_AUTOMAKE(zm,1.0.0)
AM_CONFIG_HEADER(config.h)

# Ask user for path to libmysqlclient stuff:.
AC_ARG_WITH(mysql,
    [ --with-mysql=<path> prefix of MySQL installation. e.g. /usr/local or /usr],
    [MYSQL_PREFIX=$with_mysql],
    AC_MSG_ERROR([You must call configure with the --with-mysql option.
    This tells configure where to find the MySql C library and headers.
    e.g. --with-mysql=/usr/local or --with-mysql=/usr])
)
AC_SUBST(MYSQL_PREFIX)
MYSQL_LIBS="-L${MYSQL_PREFIX}/lib/mysql -lmysqlclient"
MYSQL_CFLAGS="-I${MYSQL_PREFIX}/include"
AC_SUBST(MYSQL_LIBS)
AC_SUBST(MYSQL_CFLAGS)

AC_PROG_CC
AC_PROG_CXX
AC_PROG_INSTALL
AC_PROG_MAKE_SET

AC_HEADER_STDC

AC_LANG_CPLUSPLUS

AC_CHECK_LIB(jpeg,jpeg_start_compress,,AC_MSG_ERROR(zm requires libjpeg.a))
AC_CHECK_LIB(z,compress,,AC_MSG_ERROR(zm requires libz.a))
AC_CHECK_LIB(dl,dlsym,,AC_MSG_ERROR(zm requires libdl.a))
#AC_CHECK_LIB(mysqlclient,mysql_init,,AC_MSG_ERROR(zm requires libmysqlclient.a))

# Ask user for path to libmysqlclient stuff:.
#AC_ARG_WITH(webdir,
    #[ --webdir=<path> prefix of web installation. e.g. /var/www/html or /www/vhtdocs/site],
    #[webdir=$webdir],
    #AC_MSG_ERROR([You must call configure with the --webdir option.
    #This tells configure where to put the web files.
    #e.g. --webdir=/var/www/html or --webdir=/www/vhtdocs/site])
#)
#AC_SUBST(webdir)
AC_SUBST(bindir)

AC_OUTPUT(Makefile src/Makefile web/Makefile web/zmconfig.php scripts/Makefile scripts/zmdc.pl)

